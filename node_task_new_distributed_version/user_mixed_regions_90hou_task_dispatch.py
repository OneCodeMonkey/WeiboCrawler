import sys
import os
o_path = os.getcwd() # 返回当前工作目录
sys.path.append(o_path) # 添加自己指定的搜索路径

from logger import crawler
from tasks.workers import app

uids = [
5904219178,
3187146383,
2702755210,
2641401963,
2625670311,
2305700464,
2243695535,
1987113917,
3694710932,
1922809242,
3547400097,
2259202743,
1921463145,
3165371432,
2412265373,
3296253621,
5326456381,
2260428377,
5366122397,
2407345080,
2551050555,
3024872511,
2620733781,
3991678082,
3194076534,
1965169135,
2586760467,
5266184692,
2565773565,
2861163905,
6207862071,
5217425148,
3957516365,
3597377344,
3223701317,
2723267061,
2716422053,
2942749727,
3022945773,
3221262175,
2471496474,
2436784302,
1930494171,
2769127671,
5376418063,
3869554032,
3786025720,
3466163512,
2825474607,
2689003913,
2602413031,
2393319277,
3091652793,
2410512563,
1811444380,
5640454677,
7299943236,
5350176931,
2798873487,
2670667441,
2513193243,
2447191817,
2437086287,
5350176931,
2798873487,
2670667441,
2513193243,
2447191817,
2437086287,
2153929295,
6425869901,
2557127484,
2463874167,
2427180315,
2517109624,
2704146063,
5737781127,
2958313305,
1963711863,
1750142855,
3687387361,
2690873144,
2522434661,
2368527952,
2479639422,
5122278712,
5101902073,
2929361687,
2822625462,
2624241041,
2454526922,
2406835581,
1996291565,
2753010831,
2783519342,
5517362733,
3730032214,
2723478521,
2637088287,
2516623865,
]

count = 0
for uid in uids:
    app.send_task('tasks.home.crawl_weibo_datas', args=(uid,), queue='home_crawler', routing_key='home_info')
    count += 1
    crawler.info("count:" + str(count))
